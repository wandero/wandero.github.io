---
layout: post
title: "终极系统同步方案 Win To Go"
date: 2023-06-23 21:00:00 +0800
categories: 工具二三
tags:
    - WTG
    - Sync
---

在两台电脑间切换使用，同步不可避免，但受限于 WIn 10 本身和同步软件，同步实现问题多多。之前就接触过 Win To Go，但因为工作软件存在的激活问题没有实际尝试，这次偶然登录萝卜头IT论坛，发现完全可以尝试一下。

<!-- more -->

##  Win To Go 特点

### 优点

两台（或以上）电脑共用一套操作系统及相关资料，几乎不用考虑同步问题

###  缺点

- 可能需要额外购买硬件（固态 U 盘或固态硬盘+硬盘盒）
- 极少数软件需要反复激活或认证
- 系统和数据的稳定性难说，需要（自动）定期备份

## 需求硬件

随机4K写入速度足够的 U 盘或 SSD，推荐不需要线缆且袖珍便携的固态 U 盘，例如论坛推荐的 CHIPFANCIER 或 NUMINUO 品牌中的固态 U 盘。

特别提示，CZ 880 4K 读写非常差，WTG 体验灾难，但如果有现成的话可以制作一个先感受一下速度以外的各种使用体验，包括可行性、便利性，手头有移动硬盘的话同理。

另外我用手头的一个六年前的世特力硬盘盒加一块六年前的东芝 Q200EX SSD 部署两次都失败了，原因不详。

对 4K 读写速度没概念的话，萝卜头论坛制作了一款测速工具 [WTGBench](https://github.com/nkc3g4/WTGBench)，可以测一下，感觉跑快速测试就行，等级在 Gold 及以上就可以流畅跑 WTG。

另外电脑本身的 USB 接口规格也会影响速度上限（不影响流畅体验 WTG 需要的速度下限），直到接触 WTG，才知道所谓的 3.0gen1、3.1gen1、3.2gen1 都是 3.0 5 Gbps 规格，只有 gen2 才是 10 Gbps。体现到 WTG 上，就是 gen2 USB 接口测试速度提高一倍以上。

如果为了避免同步而使用 WTG，那 U 盘大小最好在 256G 或 512G，系统和程序加页面文件差不多就是一百多 G 了。

## 具体操作

### 准备系统安装文件

论坛普遍推荐使用 Win10 ltsc 版本并且关闭自动更新，但我目前使用了最新的 Win10 版本（22H2）正常更新没出现问题

另外所谓的 Win 10 后续版本不支持 Win To Go 似乎只是砍掉了控制面板菜单，不影响实际 WTG 使用。

下载 ISO 文件后解压。

### 部署

其实就是往 U 盘上装系统，方法很多，但最省事似乎也是最可靠的还是论坛提供的 WTG辅助工具（当前版本 v5.6.1），实际操作非常简单（Mac 电脑情况特殊，需要先使用 DISM++ 等软件打包驱动，并且有额外的注意事项。普通 PC 建议首先直接采取该部署方案，碰到问题再调整）

- 插入 U 盘，运行软件
- 点击浏览按钮，将右下角的「映像」文件改为「已解密的 ESD 文件」，选中安装文件中 sources 文件夹内的 install.esd
- 选择目标 U 盘
- 其他全部默认，点击部署即可。

合格的 U 盘几分钟就能完成部署（如果部署速度缓慢，那么运行速度也会缓慢，最好更换硬件）。据说很多 WTG 问题都是部署阶段产生的，所以遇到没有头绪的问题可以尝试重新部署。

U 部署完毕以后，最好先准备一下电脑的网卡驱动，有备无患（可以把网卡驱动复制到已部署好的 U 盘中）。

### 运行

插好 U 盘，重启电脑进入 BIOS（一般是 F2 或者 Del），如果无法进入（直接跳 Win10 登录画面）可能是 Win10 的快速启动或者主板的快速启动的影响，通过相应设置调整即可。

在 BIOS 中开启 USB BOOT 启动支持，将 U 盘设置为优先启动（一般情况下选择 UEFI 而非 Legacy 模式），退出 BIOS，顺利的话会启动 WTG 系统，接下来是常规的系统安装设置流程。

需要说明的是 WTG 系统推荐使用 Windows 自动更新的驱动方便在各台电脑前自动稳定且换，所以如果内置驱动能够正常运行尽量使用内置驱动。

默认部署屏蔽了本机硬盘，所以如果需要显示的话需要到计算机管理面板中将脱机的本地硬盘改为联机，但据说 WTG 可能破环本机系统甚至硬盘数据，所以如果可能的话还是少用本机硬盘特别是本机的系统分区，另外做好本机系统和重要文件的备份。

### 备份

建议在不熟悉 WTG 稳定性（因机器而异）的时候勤备份，一个是备份系统及后续的系统设置、软件安装，一个是备份重要的数据资料（非机械硬盘，稳定性堪忧），备份系统可以使用傲梅轻松备份（支持热备份、定时备份、增量备份等等）、备份文件可以用轻松备份也可以用其他备份或同步软件（这个不管 WTG 有多稳定都需要勤备份）。

## 其他问题

### 分区问题

如果把所有文件都放 WTG 中的话，建议不分区，因为 WTG 的系统一旦出故障，基本都需要重新部署或还原，分区的意义不大。

### 激活问题

Microsoft 365 等通过账号激活的软件还好，且换电脑打开后只是暂时提示未激活，重新打开正常。有些以许可或密钥方式激活的软件就会出问题了。

最无语的是坚果云和 iCloud Drive（虽然有 WTG 电脑之间不需要同步了，但是电脑和手机之前还是需要同步……），坚果云和 iCloud Drive 都会在切换设备后重新弹两步验证。

有些工作软件正版会需要反复激活，这个时候可以考虑破解版……

### 界面适配

两台电脑分辨率不同的话某些软件会出问题，比如 Totalcmd ，可以写一个 py 脚本来通过批处理命令快捷调整配置文件。

### 体验

下班关机，稍微等一分钟拔出 U 盘（注意 U 盘会非常烫，据说长时间大数据读写可以到75度），回家用电脑的话插 U 盘开机，系统无缝切换，再也无用重复安装软件或调整设置或者同步文件，备份自动进行也不需要人工干预。